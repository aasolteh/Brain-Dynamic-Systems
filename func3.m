function dydt = func3(t,y,I1,w1,I2,w2)
dydt = zeros(4,1);
dydt(1) = I1 * (mystepfunc(t)-mystepfunc(t-w1)) + I2 * (mystepfunc(t-15)-mystepfunc(t-15-w2)) - (3*y(1))/10 - 35*y(2)^4*(y(1) + 77) - 40*y(4)*y(3)^3*(y(1) - 55) - 39/2;
dydt(2) = ((y(1)/50 - 1/2)*(y(2) - 1))/(exp(25/9 - y(1)/9) - 1) - (y(2)*(y(1)/500 - 1/20))/(exp(y(1)/9 - 25/9) - 1);
dydt(3) = (((91*y(1))/500 + 637/100)*(y(3) - 1))/(exp(- y(1)/9 - 35/9) - 1) - (y(3)*((31*y(1))/250 + 217/50))/(exp(y(1)/9 + 35/9) - 1);
dydt(4) = - (exp(- y(1)/12 - 15/2)*(y(4) - 1))/4 - (y(4)*exp(- y(1)/12 - 15/2)*exp(y(1)/6 + 31/3))/4;
end